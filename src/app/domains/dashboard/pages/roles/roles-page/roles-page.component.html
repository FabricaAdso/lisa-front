<section id="all">
  <nz-table #basicTable [nzData]="users">
    <thead>
      <tr>
        <th>Documento</th>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Roles</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of users">
        <td>{{ user.identity_document }}</td>
        <td>{{ user.first_name }}</td>
        <td>{{ user.last_name }}</td>
        <td>
          <span *ngFor="let role of user.roles; let i = index">
            {{ role }}<span *ngIf="i < user.roles.length - 1">, </span>
          </span>
        </td>
        <td>
          <button (click)="showModal(user)" class="btn btn-primary">Editar Roles</button>
          <button  (click)="toggleUserStatus(user)" class="btn btn-secondary">
            {{ user.desactive ? 'desactivar' : 'activar' }}
          </button>
        </td>
      </tr>
    </tbody>
  </nz-table>
</section>

<nz-modal [(nzVisible)]="isVisible" nzTitle="Editar Roles y Estado" (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()">
  <ng-container *nzModalContent>
    <div class="modal-content">
      <div class="modal-body">
        <div>
          <div class="form-group">


            <label for="roles">Seleccionar Roles</label>

            <nz-select
            [nzMaxTagCount]="3"
            [nzMaxTagPlaceholder]="tagPlaceHolder"
            nzMode="multiple"
            nzPlaceHolder="Seleccione roles"
            [(ngModel)]="selectedRoles"
            name="roles"
            (ngModelChange)="onRolesChange($event)">

            <nz-option *ngFor="let role of allRoles" [nzLabel]="role" [nzValue]="role"></nz-option>
          </nz-select>
          <ng-template #tagPlaceHolder let-selectedList>y {{ selectedList.length }} m√°s seleccionados</ng-template>
          </div>
          <div class="form-check">
            <input type="checkbox" id="active" [(ngModel)]="isActive" name="active" class="form-check-input" (change)="onStatusChange()">
            <label for="active" class="form-check-label">{{ isActive ? ' Activar usuario': 'Desactivar usuario'  }}</label>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</nz-modal>
