<div class="flex justify-end">
  <button nz-button nzType="primary" (click)="openModal()">Crear session</button>
  <button nz-button nzType="primary" (click)="openAnotherModal()">Crear otro modal</button>
</div>
<div class="main-container">
  <!-- Contenedor de Fichas Activas -->
  <div class="fichas-container">
    <h1>FICHAS</h1>
    <!-- modales -->
    <app-session [isModalVisible]="createSessionOpen" #sessionModal></app-session>

    <!-- modal para sesiones -->
    <nz-modal [(nzVisible)]="anotherModalOpen" nzTitle="Fichas" (nzOnCancel)="closeAnotherModal()"
  (nzOnOk)="handleAnotherModalOk()">
  <ng-container *nzModalContent>
    <nz-tabs [nzTabPosition]="'top'">
      <nz-tab *ngFor="let session of pending_courses" [nzTab]="session.course?.code">
        <ng-template #content>
          <div *ngFor="let ses of session.sessions">
            <nz-card [nzBordered]="true" [nzBodyStyle]="{ padding: '2px' }">
              <div class="ficha-header">Sesi贸n: {{ ses.start_time }} - {{ ses.end_time }}</div>
              <div class="ficha-content">
                <p><strong>Programa:</strong> {{ session.course?.program?.name || 'No disponible' }}</p>
                <p><strong>Sede:</strong> {{ session.course?.environment?.headquarters?.name || 'No disponible' }}</p>
                <p><strong>Ambiente:</strong> {{ session.course?.environment?.name || 'No disponible' }}</p>
                <div class="ficha-details">
                  <p><strong>Fecha:</strong> {{ ses.date }}</p>
                </div>
                <button nz-button nzType="default" (click)="deleteSession(ses.id, session.course?.id)">Eliminar sesi贸n</button>
              </div>
            </nz-card>
          </div>
        </ng-template>
      </nz-tab>
    </nz-tabs>
  </ng-container>
</nz-modal>


    <!-- -------------------------------------------------------------------------------------------------------------- -->



    <div nz-row [nzGutter]="16">
      <div nz-col [nzSpan]="6" *ngFor="let session of pending_courses">
        <a [routerLink]="[session.course!.code,'attendance']">
          <nz-card [nzBordered]="true" [nzBodyStyle]="{ padding: '2px' }">
            <div class="ficha-header">Ficha: {{ session.course!.code || 'No disponible' }}</div>
            <div class="ficha-content">
              <p><strong>Programa:</strong> {{ session.course?.program?.name || 'No disponible' }}</p>
              <p><strong>Sede:</strong> {{ session.course?.environment?.headquarters?.name || 'No disponible' }}</p>
              <p><strong>Ambiente:</strong> {{ session.course?.environment?.name || 'No disponible' }}</p>
              <div class="ficha-details">
                <p><strong>Sesi贸n:</strong> {{ session.start_time }}-{{ session.end_time }}</p>
                <p><strong>Fecha:</strong> {{ session.date }}</p>
              </div>
            </div>
          </nz-card>
        </a>
      </div>
    </div>
  </div>

  <!-- Historial de Fichas -->
  <nz-collapse>
    <nz-collapse-panel [nzHeader]="'HISTORIAL DE FICHAS'" [nzShowArrow]="true">
      <div class="historial-fichas-container">
        <div nz-row [nzGutter]="16">
          <div nz-col [nzSpan]="6" *ngFor="let session of record_courses">
            <a [routerLink]="[session.course!.code,'attendance']">
              <nz-card [nzBordered]="true" [nzBodyStyle]="{ padding: '2px' }">
                <div class="ficha-header-historal">Ficha: {{ session.course?.code || 'No disponible' }}</div>
                <div class="ficha-content">
                  <p><strong>Programa:</strong> {{ session.course?.program?.name }}</p>
                  <p><strong>Sede:</strong> {{ session.course?.environment?.headquarters?.name }}</p>
                  <p><strong>Ambiente:</strong> {{ session.course?.environment?.name }}</p>
                  <div class="ficha-details">
                    <p><strong>Sesi贸n:</strong> {{ session.start_time }}</p>
                    <p><strong>Fecha:</strong> {{ session.date }}</p>
                  </div>
                </div>
              </nz-card>
            </a>
          </div>
        </div>
      </div>
    </nz-collapse-panel>
  </nz-collapse>
